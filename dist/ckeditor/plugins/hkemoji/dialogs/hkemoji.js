CKEDITOR.dialog.add("hkemojiDialog",(function(e){var t,o=e.config,i=function(o){var i=o.data.getTarget(),a=i.getName();if("a"==a)i=i.getChild(0);else if("img"!=a)return;a=i.getAttribute("cke_src"),i=e.document.createElement("img",{attributes:{src:a,"data-cke-saved-src":a,width:i.$.width,height:i.$.height}}),e.insertElement(i),t.hide(),o.data.preventDefault()},a=CKEDITOR.tools.addFunction((function(t,o){var a;t=new CKEDITOR.dom.event(t),o=new CKEDITOR.dom.element(o),a=t.getKeystroke();var n="rtl"==e.lang.dir;switch(a){case 38:(a=o.getParent().getParent().getPrevious())&&(a=a.getChild([o.getParent().getIndex(),0])).focus(),t.preventDefault();break;case 40:(a=o.getParent().getParent().getNext())&&(a=a.getChild([o.getParent().getIndex(),0]))&&a.focus(),t.preventDefault();break;case 32:i({data:t}),t.preventDefault();break;case n?37:39:(a=o.getParent().getNext())?((a=a.getChild(0)).focus(),t.preventDefault(!0)):(a=o.getParent().getParent().getNext())&&((a=a.getChild([0,0]))&&a.focus(),t.preventDefault(!0));break;case n?39:37:(a=o.getParent().getPrevious())?((a=a.getChild(0)).focus(),t.preventDefault(!0)):(a=o.getParent().getParent().getPrevious())&&((a=a.getLast().getChild(0)).focus(),t.preventDefault(!0))}})),n=function(e){var t,i=['<div style="max-height:300px;overflow-y:scroll;"><style type="text/css">.hkemoji:hover {border:1pt solid;border-color: green;background-color:#e6ffff}</style><span id="'+(i=CKEDITOR.tools.getNextId()+"_smiley_emtions_label")+'" class="cke_voice_label">Test</span>','<table role="listbox" aria-labelledby="'+i+'" style="width:100%;height:100%;border-collapse:separate;" cellspacing="2" cellpadding="2"',CKEDITOR.env.ie&&CKEDITOR.env.quirks?' style="position:absolute;"':"","><tbody>"],n={},r=0;for(t in o.hkemoji.emojis[e])n[s=o.hkemoji.emojis[e][t]]=t;for(t in n)if(0==r%6&&i.push('<tr role="presentation">'),n.hasOwnProperty(t)){var l,s=n[t];for(l in s)s.hasOwnProperty(l);s=o.smiley_path+e+"/"+t,i.push('<td class="cke_centered" style="vertical-align: middle;" role="presentation"><img class="hkemoji" cke_src="'+CKEDITOR.tools.htmlEncode(s)+'" src="'+s+'" href="javascript:void(0)" onkeydown="CKEDITOR.tools.callFunction( ',a,', event, this );"/>',"</td>"),5==r%6&&i.push("</tr>"),r++}if(5>r){for(;5>r;r++)i.push("<td></td>");i.push("</tr>")}return i.push("</tbody></table></div>"),i},r=function(e){return{type:"html",id:"emojiSelector",html:n(e).join(""),onLoad:function(e){t=e.sender},onClick:i,style:"width: 100%; border-collapse: separate;"}};return{title:"HK Emoji",minWidth:550,minHeight:200,contents:[{id:"tab-onion",label:e.config.hkemoji.tabs.onion,elements:[r("onion")]},{id:"tab-red",label:e.config.hkemoji.tabs.red,elements:[r("red")]},{id:"tab-milkbottle",label:e.config.hkemoji.tabs.milkbottle,elements:[r("milkbottle")]},{id:"tab-facebook",label:e.config.hkemoji.tabs.facebook,elements:[r("facebook")]}],onShow:function(){}}}));