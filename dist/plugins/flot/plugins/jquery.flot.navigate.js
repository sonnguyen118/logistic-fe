!function(t){"use strict";var e=t.plot.saturated,a=t.plot.browser,o=t.plot.uiConstants.SNAPPING_CONSTANT,n=t.plot.uiConstants.PANHINT_LENGTH_CONSTANT;function i(i,r){var s,f=null,c=!1,l="manual"===r.pan.mode,u="smartLock"===r.pan.mode,p=u||"smart"===r.pan.mode,d="default",g=null,v=null,x={x:0,y:0},m=!1;function h(t,e){var o=Math.abs(t.originalEvent.deltaY)<=1?1+Math.abs(t.originalEvent.deltaY)/50:null;if(m&&M(t),i.getOptions().zoom.active)return t.preventDefault(),function(t,e,o){var n=a.getPageXY(t),r=i.offset();r.left=n.X-r.left,r.top=n.Y-r.top;var s=i.getPlaceholder().offset();s.left=n.X-s.left,s.top=n.Y-s.top;var f=i.getXAxes().concat(i.getYAxes()).filter((function(t){var e=t.box;if(void 0!==e)return s.left>e.left&&s.left<e.left+e.width&&s.top>e.top&&s.top<e.top+e.height}));0===f.length&&(f=void 0),e?i.zoomOut({center:r,axes:f,amount:o}):i.zoom({center:r,axes:f,amount:o})}(t,e<0,o),!1}function b(t){c=!0}function y(t){c=!1}function P(t){if(!c||!function(t){return 0===t.button}(t))return!1;m=!0;var e=a.getPageXY(t),o=i.getPlaceholder().offset();o.left=e.X-o.left,o.top=e.Y-o.top,0===(f=i.getXAxes().concat(i.getYAxes()).filter((function(t){var e=t.box;if(void 0!==e)return o.left>e.left&&o.left<e.left+e.width&&o.top>e.top&&o.top<e.top+e.height}))).length&&(f=void 0);var n=i.getPlaceholder().css("cursor");n&&(d=n),i.getPlaceholder().css("cursor",i.getOptions().pan.cursor),p?s=i.navigationState(e.X,e.Y):l&&(x.x=e.X,x.y=e.Y)}function w(t){if(m){var e=a.getPageXY(t),o=i.getOptions().pan.frameRate;-1!==o?!v&&o&&(v=setTimeout((function(){p?i.smartPan({x:s.startPageX-e.X,y:s.startPageY-e.Y},s,f,!1,u):l&&(i.pan({left:x.x-e.X,top:x.y-e.Y,axes:f}),x.x=e.X,x.y=e.Y),v=null}),1/o*1e3)):p?i.smartPan({x:s.startPageX-e.X,y:s.startPageY-e.Y},s,f,!1,u):l&&(i.pan({left:x.x-e.X,top:x.y-e.Y,axes:f}),x.x=e.X,x.y=e.Y)}}function M(t){if(m){v&&(clearTimeout(v),v=null),m=!1;var e=a.getPageXY(t);i.getPlaceholder().css("cursor",d),p?(i.smartPan({x:s.startPageX-e.X,y:s.startPageY-e.Y},s,f,!1,u),i.smartPan.end()):l&&(i.pan({left:x.x-e.X,top:x.y-e.Y,axes:f}),x.x=0,x.y=0)}}function Y(e){if(i.activate(),i.getOptions().recenter.interactive){var a,o=i.getTouchedAxis(e.clientX,e.clientY);i.recenter({axes:o[0]?o:null}),a=o[0]?new t.Event("re-center",{detail:{axisTouched:o[0]}}):new t.Event("re-center",{detail:e}),i.getPlaceholder().trigger(a)}}function O(t){return i.activate(),m&&M(t),!1}i.navigationState=function(t,e){var a=this.getAxes(),o={};return Object.keys(a).forEach((function(t){var e=a[t];o[t]={navigationOffset:{below:e.options.offset.below||0,above:e.options.offset.above||0},axisMin:e.min,axisMax:e.max,diagMode:!1}})),o.startPageX=t||0,o.startPageY=e||0,o},i.activate=function(){var t=i.getOptions();t.pan.active&&t.zoom.active||(t.pan.active=!0,t.zoom.active=!0,i.getPlaceholder().trigger("plotactivated",[i]))},i.zoomOut=function(t){t||(t={}),t.amount||(t.amount=i.getOptions().zoom.amount),t.amount=1/t.amount,i.zoom(t)},i.zoom=function(e){e||(e={});var a=e.center,o=e.amount||i.getOptions().zoom.amount,n=i.width(),r=i.height(),s=e.axes||i.getAxes();a||(a={left:n/2,top:r/2});var f=a.left/n,c=a.top/r,l={x:{min:a.left-f*n/o,max:a.left+(1-f)*n/o},y:{min:a.top-c*r/o,max:a.top+(1-c)*r/o}};for(var u in s)if(s.hasOwnProperty(u)){var p=s[u],d=p.options,g=l[p.direction].min,v=l[p.direction].max,x=p.options.offset;if((d.axisZoom||!e.axes)&&(e.axes||d.plotZoom)){if((g=t.plot.saturated.saturate(p.c2p(g)))>(v=t.plot.saturated.saturate(p.c2p(v)))){var m=g;g=v,v=m}if(d.zoomRange){if(v-g<d.zoomRange[0])continue;if(v-g>d.zoomRange[1])continue}var h=t.plot.saturated.saturate(x.below-(p.min-g)),b=t.plot.saturated.saturate(x.above-(p.max-v));d.offset={below:h,above:b}}}i.setupGrid(!0),i.draw(),e.preventEvent||i.getPlaceholder().trigger("plotzoom",[i,e])},i.pan=function(a){var o={x:+a.left,y:+a.top};isNaN(o.x)&&(o.x=0),isNaN(o.y)&&(o.y=0),t.each(a.axes||i.getAxes(),(function(t,n){var i=n.options,r=o[n.direction];if((i.axisPan||!a.axes)&&(i.plotPan||a.axes)){var s=n.p2c(i.panRange[0])-n.p2c(n.min),f=n.p2c(i.panRange[1])-n.p2c(n.max);if(void 0!==i.panRange[0]&&r>=f&&(r=f),void 0!==i.panRange[1]&&r<=s&&(r=s),0!==r){var c=e.saturate(n.c2p(n.p2c(n.min)+r)-n.c2p(n.p2c(n.min))),l=e.saturate(n.c2p(n.p2c(n.max)+r)-n.c2p(n.p2c(n.max)));isFinite(c)||(c=0),isFinite(l)||(l=0),i.offset={below:e.saturate(c+(i.offset.below||0)),above:e.saturate(l+(i.offset.above||0))}}}})),i.setupGrid(!0),i.draw(),a.preventEvent||i.getPlaceholder().trigger("plotpan",[i,a])},i.recenter=function(e){t.each(e.axes||i.getAxes(),(function(t,a){e.axes?"x"===this.direction?a.options.offset={below:0}:"y"===this.direction&&(a.options.offset={above:0}):a.options.offset={below:0,above:0}})),i.setupGrid(!0),i.draw()};var X=null,T={x:0,y:0};i.smartPan=function(t,a,n,r,s){var f,c,l,u,p,d,v=!!s||function(t){return Math.abs(t.y)<o&&Math.abs(t.x)>=o||Math.abs(t.x)<o&&Math.abs(t.y)>=o}(t),x=i.getAxes();(function(t){return Math.abs(t.x)>0&&Math.abs(t.y)>0})(t=s?function(t){switch(!X&&Math.max(Math.abs(t.x),Math.abs(t.y))>=o&&(X=Math.abs(t.x)<Math.abs(t.y)?"y":"x"),X){case"x":return{x:t.x,y:0};case"y":return{x:0,y:t.y};default:return{x:0,y:0}}}(t):function(t){return Math.abs(t.x)<o&&Math.abs(t.y)>=o?{x:0,y:t.y}:Math.abs(t.y)<o&&Math.abs(t.x)>=o?{x:t.x,y:0}:t}(t))&&(a.diagMode=!0),v&&!0===a.diagMode&&(a.diagMode=!1,function(t,e,a){var o;Object.keys(t).forEach((function(n){o=t[n],0===a[o.direction]&&(o.options.offset.below=e[n].navigationOffset.below,o.options.offset.above=e[n].navigationOffset.above)}))}(x,a,t)),g=v?{start:{x:a.startPageX-i.offset().left+i.getPlotOffset().left,y:a.startPageY-i.offset().top+i.getPlotOffset().top},end:{x:a.startPageX-t.x-i.offset().left+i.getPlotOffset().left,y:a.startPageY-t.y-i.offset().top+i.getPlotOffset().top}}:{start:{x:a.startPageX-i.offset().left+i.getPlotOffset().left,y:a.startPageY-i.offset().top+i.getPlotOffset().top},end:!1},isNaN(t.x)&&(t.x=0),isNaN(t.y)&&(t.y=0),n&&(x=n),Object.keys(x).forEach((function(a){if(c=x[a],l=c.min,u=c.max,f=c.options,d=t[c.direction],p=T[c.direction],(f.axisPan||!n)&&(n||f.plotPan)){var o=p+c.p2c(f.panRange[0])-c.p2c(l),i=p+c.p2c(f.panRange[1])-c.p2c(u);if(void 0!==f.panRange[0]&&d>=i&&(d=i),void 0!==f.panRange[1]&&d<=o&&(d=o),0!==d){var r=e.saturate(c.c2p(c.p2c(l)-(p-d))-c.c2p(c.p2c(l))),s=e.saturate(c.c2p(c.p2c(u)-(p-d))-c.c2p(c.p2c(u)));isFinite(r)||(r=0),isFinite(s)||(s=0),c.options.offset.below=e.saturate(r+(c.options.offset.below||0)),c.options.offset.above=e.saturate(s+(c.options.offset.above||0))}}})),T=t,i.setupGrid(!0),i.draw(),r||i.getPlaceholder().trigger("plotpan",[i,t,n,a])},i.smartPan.end=function(){g=null,X=null,T={x:0,y:0},i.triggerRedrawOverlay()},i.getTouchedAxis=function(t,e){var a=i.getPlaceholder().offset();return a.left=t-a.left,a.top=e-a.top,i.getXAxes().concat(i.getYAxes()).filter((function(t){var e=t.box;if(void 0!==e)return a.left>e.left&&a.left<e.left+e.width&&a.top>e.top&&a.top<e.top+e.height}))},i.hooks.drawOverlay.push((function(t,e){if(g){e.strokeStyle="rgba(96, 160, 208, 0.7)",e.lineWidth=2,e.lineJoin="round";var a,o,i=Math.round(g.start.x),r=Math.round(g.start.y);if(f?"x"===f[0].direction?(o=Math.round(g.start.y),a=Math.round(g.end.x)):"y"===f[0].direction&&(a=Math.round(g.start.x),o=Math.round(g.end.y)):(a=Math.round(g.end.x),o=Math.round(g.end.y)),e.beginPath(),!1===g.end)e.moveTo(i,r-n),e.lineTo(i,r+n),e.moveTo(i+n,r),e.lineTo(i-n,r);else{var s=r===o;e.moveTo(i-(s?0:n),r-(s?n:0)),e.lineTo(i+(s?0:n),r+(s?n:0)),e.moveTo(i,r),e.lineTo(a,o),e.moveTo(a-(s?0:n),o-(s?n:0)),e.lineTo(a+(s?0:n),o+(s?n:0))}e.stroke()}})),i.hooks.bindEvents.push((function(t,e){var a=t.getOptions();a.zoom.interactive&&e.mousewheel(h),a.pan.interactive&&(t.addEventHandler("dragstart",P,e,0),t.addEventHandler("drag",w,e,0),t.addEventHandler("dragend",M,e,0),e.bind("mousedown",b),e.bind("mouseup",y)),e.dblclick(Y),e.click(O)})),i.hooks.shutdown.push((function(t,e){e.unbind("mousewheel",h),e.unbind("mousedown",b),e.unbind("mouseup",y),e.unbind("dragstart",P),e.unbind("drag",w),e.unbind("dragend",M),e.unbind("dblclick",Y),e.unbind("click",O),v&&clearTimeout(v)}))}t.plot.plugins.push({init:function(t){t.hooks.processOptions.push(i)},options:{zoom:{interactive:!1,active:!1,amount:1.5},pan:{interactive:!1,active:!1,cursor:"move",frameRate:60,mode:"smart"},recenter:{interactive:!0},xaxis:{axisZoom:!0,plotZoom:!0,axisPan:!0,plotPan:!0,panRange:[void 0,void 0],zoomRange:[void 0,void 0]},yaxis:{axisZoom:!0,plotZoom:!0,axisPan:!0,plotPan:!0,panRange:[void 0,void 0],zoomRange:[void 0,void 0]}},name:"navigate",version:"1.3"})}(jQuery);